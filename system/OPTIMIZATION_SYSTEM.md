# Система оптимизации производительности MTProxy

## Обзор

Новая система оптимизации производительности была добавлена в MTProxy для улучшения производительности, масштабируемости и эффективности использования ресурсов. Система включает в себя несколько уровней оптимизации, начиная от простых до продвинутых.

## Компоненты системы

### 1. Простая система оптимизации (`simple-performance-optimizer`)

Простая система оптимизации предназначена для интеграции с основным кодом MTProxy без дополнительных зависимостей. Она включает:

- Мониторинг базовой производительности
- Управление оптимизациями на основе нагрузки
- Сбор метрик производительности

### 2. Продвинутая система оптимизации (`performance-optimizer`)

Продвинутая система оптимизации включает более сложные алгоритмы:

- Оптимизация привязки CPU
- Управление пулом потоков
- Адаптивная настройка параметров под нагрузку

### 3. Интеграционный слой (`optimizer-integration`)

Интеграционный слой обеспечивает связь между системой оптимизации и основным движком MTProxy.

## Использование

Система оптимизации автоматически инициализируется при запуске MTProxy. Основные функции:

- `simple_init_optimizer()` - Инициализация простой системы оптимизации
- `simple_adjust_for_load()` - Адаптация под текущую нагрузку
- `simple_get_metrics()` - Получение метрик производительности

## Уровни оптимизации

Система поддерживает несколько уровней оптимизации:

- **BASIC** - Минимальные оптимизации
- **ADVANCED** - Средний уровень оптимизаций
- **AGGRESSIVE** - Агрессивные оптимизации для высокой нагрузки
- **MAXIMUM** - Максимальные оптимизации

## Интеграция с системой сборки

Система оптимизации интегрирована с обоими системами сборки:

- **CMake**: Автоматическое включение файлов в `CMakeLists.txt`
- **Make**: Обновленный `Makefile` с новыми объектными файлами

## Преимущества

- Улучшенная производительность под высокой нагрузкой
- Эффективное использование ресурсов CPU и памяти
- Автоматическая адаптация к изменяющейся нагрузке
- Совместимость с существующим кодом MTProxy